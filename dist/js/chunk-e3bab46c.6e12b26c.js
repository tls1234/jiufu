(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e3bab46c"],{"0e77":function(t,e,i){"use strict";i.r(e);var s={name:"phone-bind",data:function(){return{type:3,text:"下一步"}},components:{registerForm:i("3133").a}},o=i("6691"),n=Object(o.a)(s,function(){var t=this,e=t.$createElement;return(t._self._c||e)("register-form",{attrs:{"register-type":t.type,"submit-text":t.text}})},[],!1,null,null,null);e.default=n.exports},3133:function(t,e,i){"use strict";i("34a3"),i("d4d5");var s=i("4b90"),o=function(t){return/^1[3-9]\d{9}$/.test(t)},n=i("5d2d"),r="password",c="86",a="获取验证码",u={props:{registerType:{type:Number,default:1},submitText:{type:String,default:"立即注册"},placeholder:{type:String,default:"请设置密码（6-16位字符）"}},data:function(){return{passwordType:r,countryCode:c,captchaTips:a,showCountryList:!1,isSendCode:!1,timer:null,timeout:60,loginForm:{certCode:"",pwd:"",captcha:"",eventId:0},loginRules:{certCode:{tips:""},pwd:{tips:""},captcha:{tips:""}}}},computed:{query:function(){return this.$route.query},isCanSend:function(){return 1<this.loginForm.certCode.length},isDisabled:function(){var t=this.loginForm,e=t.certCode,i=t.pwd,s=t.captcha;return(e.length&&i.length&&s.length)<1},itemCodeClass:function(){return{"item-code":!0,active:this.isCanSend}},iconEyeClass:function(){var t=this.passwordType===r;return{"icon-eye":!0,"icon-eye-close":t,"icon-eye-open":!t}}},methods:{handleShowCountryList:function(){this.showCountryList=!0},selectItem:function(t){var e=t.value;this.countryCode=e,this.showCountryList=!1},handleSendCode:function(){if(this.isSendCode||!this.isCanSend)return!1;var t=this.countryCode,e=this.loginForm.certCode;if(t===c&&!o(e))return!(this.loginRules.certCode.tips="请输入正确的手机号码");if(this.loginRules.certCode.tips="",!e)return!(this.loginRules.certCode.tips="手机号码不能为空");this.loginRules.certCode.tips="",this.isSendCode=!0;var i={phoneNum:t===c?e:"".concat(t,"-").concat(e)};switch(this.registerType){case 1:this.fetchRegister(i);break;case 2:this.fetchPasswordRest(i);break;default:this.fetchRegister(i)}},fetchRegister:function(t){var e=this;this.$store.dispatch("checkMobile",t).then(function(i){if("Y"===i.result.isReg)return e.$createToast({type:"error",txt:"手机号已被其他用户注册",onTimeout:function(){e.isSendCode=!1}}).show(),!1;e.fetchPasswordRest(t)})},fetchPasswordRest:function(t){var e=this,i=Object.assign({},{certType:0},t);this.$store.dispatch("sendCode",i).then(function(t){var i=t.result.eventId;e.loginForm.eventId=i,e.timer=setInterval(function(){return e.timeClock()},1e3)})},timeClock:function(){this.timeout--,this.captchaTips=this.timeout+"s",this.timeout<0&&(clearTimeout(this.timer),this.isSendCode=!1,this.captchaTips=a)},handleTogglePassword:function(){this.passwordType===r?this.passwordType="text":this.passwordType=r},handleSubmit:function(){if(this.chechFormRules())switch(this.registerType){case 1:this.submitRegister();break;case 2:this.submitPasswordReset();break;case 3:this.submitPhoneBind();break;default:this.submitRegister()}},submitPhoneBind:function(){var t=this,e=this.countryCode,i=this.loginForm.certCode,s=e===c?i:"".concat(e,"-").concat(i),o=Object.assign({},this.loginForm,{phoneNum:s});this.$store.dispatch("updateMobile",o).then(function(){t.$createToast({type:"correct",txt:"绑定成功",onTimeout:function(){t.handleLoginSuccess()}}).show()})},submitPasswordReset:function(){var t=this,e=this.countryCode,i=this.loginForm.pwd,s=this.loginForm.certCode,o=e===c?s:"".concat(e,"-").concat(s),n=Object.assign({},this.loginForm,{phoneNum:o,newPwd:i});this.$store.dispatch("resetPassword",n).then(function(){t.$createToast({type:"correct",txt:"操作成功，请返回重新登录",time:3e3,onTimeout:function(){t.handlePasswordSuccess()}}).show()})},submitRegister:function(){var t=this,e=Object(s.a)(),i=e.channelId,o=void 0===i?1:i,r=e.invUserId,a=void 0===r?1:r,u=e.utm_source,l=void 0===u?"Web":u,d=e.utm_medium,h=void 0===d?"mobile-pc":d,p=e.sourceCode,m=void 0===p?"":p,g=this.countryCode,f=this.loginForm.certCode,v=g===c?f:"".concat(g,"-").concat(f),C=Object.assign({},this.loginForm,{certCode:v,certType:0,invUserId:a,sourceCode:m,userSourceChannelId:o,regSourceType:l,regSource:h});this.$store.dispatch("register",C).then(function(e){0===e.code&&t.$createToast({type:"correct",txt:"注册成功",onTimeout:function(){n.c("user",e),t.handleLoginSuccess()}}).show()})},getUserType:function(t){var e=this;this.$store.dispatch("getUserType").then(function(i){i&&2===i.type&&(e.$store.dispatch("logout"),location.href="https://sns.9fstock.com/webstatic/downApp/download_stock.html"),t&&t()})},handlePasswordSuccess:function(){var t=this;this.$store.dispatch("logout",{}).then(function(){t.$router.replace({name:"login",query:t.query})})},handleLoginSuccess:function(){this.$router.push({path:"/finish",query:{register:"register"}})},chechFormRules:function(){var t=this.loginForm,e=t.certCode,i=t.pwd,s=t.eventId,o=t.captcha;return e?(this.loginRules.certCode.tips="",0===s?!(this.loginRules.captcha.tips="请先获取验证码"):(this.loginRules.captcha.tips="",o?(this.loginRules.captcha.tips="",!i||i.length<6||16<i.length?!(this.loginRules.pwd.tips="密码必须为6-16位字符"):!(this.loginRules.pwd.tips="")):!(this.loginRules.captcha.tips="请输入验证码"))):!(this.loginRules.certCode.tips="请输入正确的手机号码")}}},l=i("6691"),d=Object(l.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"login"},[i("div",{staticClass:"login-form"},[i("div",{staticClass:"form-item"},[i("div",{staticClass:"item-input"},[i("span",{staticClass:"item-country",on:{click:t.handleShowCountryList}},[t._v("\n          +"+t._s(t.countryCode)+"\n        ")]),i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.loginForm.certCode,expression:"loginForm.certCode",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入手机号码"},domProps:{value:t.loginForm.certCode},on:{input:function(e){e.target.composing||t.$set(t.loginForm,"certCode",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),i("div",{staticClass:"item-tips error-msg"},[t._v(t._s(t.loginRules.certCode.tips))])]),i("div",{staticClass:"form-item"},[i("div",{staticClass:"item-input"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.loginForm.captcha,expression:"loginForm.captcha",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入短信验证码"},domProps:{value:t.loginForm.captcha},on:{input:function(e){e.target.composing||t.$set(t.loginForm,"captcha",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),i("span",{class:t.itemCodeClass,on:{click:t.handleSendCode}},[t._v("\n          "+t._s(t.captchaTips)+"\n        ")])]),i("div",{staticClass:"item-tips error-msg"},[t._v(t._s(t.loginRules.captcha.tips))])]),i("div",{staticClass:"form-item"},[i("div",{staticClass:"item-input"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.loginForm.pwd,expression:"loginForm.pwd",modifiers:{trim:!0}}],attrs:{type:t.passwordType,placeholder:t.placeholder},domProps:{value:t.loginForm.pwd},on:{input:function(e){e.target.composing||t.$set(t.loginForm,"pwd",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),i("span",{staticClass:"item-icon",on:{click:t.handleTogglePassword}},[i("i",{class:t.iconEyeClass})])]),i("div",{staticClass:"item-tips error-msg"},[t._v(t._s(t.loginRules.pwd.tips))])]),i("div",{staticClass:"form-item form-btn"},[i("cube-button",{attrs:{disabled:t.isDisabled},on:{click:t.handleSubmit}},[t._v(t._s(t.submitText))])],1)]),t.showCountryList?[i("country-list",{on:{selectItem:t.selectItem}})]:t._e()],2)},[],!1,null,"5c475c09",null);e.a=d.exports},"4b90":function(t,e,i){"use strict";function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:location.search.substr(1);return t?JSON.parse('{"'+decodeURIComponent(t).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}'):{}}function o(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:location.href).split("#"),e={};return t.forEach(function(t){var i=t,s=i.indexOf("?");if(i=i.substr(s+1),-1<s)for(var o=i.split("&"),n=0;n<o.length;n+=1){var r=o[n].indexOf("=");if(0<r){var c=o[n].substring(0,r),a=o[n].substr(r+1);e[c]=decodeURIComponent(a)}else{var u=o[n];""!==u&&(e[u]=!0)}}}),e}i.d(e,"b",function(){return s}),i.d(e,"a",function(){return o}),i("f763"),i("7bc1"),i("55a0"),i("9090"),i("34a3"),i("3c6b")},"55a0":function(t,e,i){"use strict";var s=i("a013"),o=i("4b0a"),n=i("35dd");i("629c")("search",1,function(t,e,i,r){return[function(i){var s=t(this),o=null==i?void 0:i[e];return void 0!==o?o.call(i,s):new RegExp(i)[e](String(s))},function(t){var e=r(i,t,this);if(e.done)return e.value;var c=s(t),a=String(this),u=c.lastIndex;o(u,0)||(c.lastIndex=0);var l=n(c,a);return o(c.lastIndex,u)||(c.lastIndex=u),null===l?-1:l.index}]})}}]);